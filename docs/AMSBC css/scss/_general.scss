@use "sass:map";
@use "theme" as *;
@use "base-utils" as *;



/* -- GENERAL STYLES START -- */
html {
  line-height: var(--lh-body);
  overflow-x: hidden;
  scroll-padding-top: var(--nav-offset);
}

body {
  background: var(--color-surface-base);
  color: var(--color-ink-primary);
  accent-color: var(--color-brand-primary);
  font-family: var(--font-sans);
}




/* -- SKIP LINKS START -- */
a#skiplink {
  position: absolute;
  top: auto;
  left: -99999px;
  height: calc(0.1 * var(--base-10));
  width: calc(0.1 * var(--base-10));
  overflow: hidden;

  &:focus,
  &:active {
    left: 0;
    top: 0;
    width: auto;
    height: auto;
    overflow: auto;
    @include base-space(padding, 1.5);
    font-weight: bold;
    font-size: var(--step-0);
    background: var(--color-surface-base);
    z-index: 999;
    box-shadow: $boxShadow;
  }
}
/* -- SKIP LINKS END -- */

/* Utility font helpers */
.u-font-spectral {
  font-family: var(--font-serif);
}

::selection {
  background: var(--color-brand-primary-bright);
  color: var(--color-ink-on-dark);
}

a,
a:link {
  color: var(--color-brand-primary-bright);
  transition: all 250ms ease-out;
}

a:visited {
  color: var(--color-brand-primary-visited);
}

a:hover,
a:focus {
  color: var(--color-brand-primary-hover);
}

.btn:link,
.btn:visited {
  @include btn;
}

.btn:hover,
.btn:focus {
  @include btn-hover;
}

blockquote {
  background: #{$brandPrimary}11;
  font-style: italic;
  @include base-space(padding, 4, 2.4, 3.2);
  border-radius: var(--radius-sm);
  position: relative;
  margin-block: base-step(5.6);

  p:last-of-type {
    margin-bottom: 0;
  }

  cite {
    display: block;
    font-size: var(--font-label);
    font-style: normal;
    color: var(--color-brand-primary);
    padding-top: base-step(1.2);
  }

  &:before {
    content: open-quote;
    font-family: "Georgia", "Times New Roman", serif;
    font-style: normal;
    font-size: calc(9.6 * var(--base-10));
    line-height: 1;
    color: var(--color-ink-on-dark);
    position: absolute;
    top: 0;
    left: 50%;
    transform: translate(-50%, -25%);
    pointer-events: none;
    z-index: 1;
  }

  &:after {
    content: close-quote;
    width: base-step(5.6);
    aspect-ratio: 1;
    background: var(--color-brand-primary);
    border-radius: var(--radius-max);
    position: absolute;
    top: 0;
    left: 50%;
    transform: translate(-50%, -50%);
    color: transparent;
    outline: calc(0.4 * var(--base-10)) solid var(--color-ink-on-dark);
  }
}

hr {
  background-color: var(--color-brand-primary);
  border: medium none;
  clear: both;
  color: var(--color-brand-primary);
  display: block;
  margin-block: clamp(calc(3.2 * var(--base-10)), 2.93040293040293vw, calc(4.8 * var(--base-10)));
  margin-inline: auto;
  height: 0.1rem;
  width: 65%;
}

img[style*="float: right"],
img[align="right"] {
  display: block;
  float: right;
  margin: 0 0 clamp(calc(1.6 * var(--base-10)), 1.8867924528301887vw, calc(3.2 * var(--base-10)))
    clamp(calc(1.6 * var(--base-10)), 1.8867924528301887vw, calc(3.2 * var(--base-10))); /* 32/1696 */
  max-width: 45%;
}

img[style*="float: left"],
img[align="left"] {
  display: block;
  float: left;
  margin: 0 clamp(calc(1.6 * var(--base-10)), 1.8867924528301887vw, calc(3.2 * var(--base-10)))
    clamp(calc(1.6 * var(--base-10)), 1.8867924528301887vw, calc(3.2 * var(--base-10))) 0;
  max-width: 45%;
}

h1,
h3 {
  font-family: var(--font-serif);
}
h2 {
  font-weight: 400;
}
:where(h1, h2, h3, h4, h5, h6) {
  color: var(--color-brand-primary);
  margin-bottom: base-step(1.2);
}

p,
ol,
ul,
dl,
pre,
code {
  margin: 0 0 base-step(3.2);
}

ol,
ul {
  margin: 0 0 base-step(4) base-step(3.2);
}

ul p:last-child,
ol p:last-child,
blockquote p:last-child {
  margin-bottom: 0;
}

dt {
  font-weight: bold;
  font-style: italic;
  color: var(--color-ink-strong);
}

table {
  border-collapse: collapse;
  width: 100%;
  box-shadow: $boxShadowSubtle;
  margin-bottom: base-step(4.8);

  & > tr {
    th:first-child,
    td:first-child {
      border-top-left-radius: calc(0.4 * var(--base-10));
    }

    th:last-child,
    td:last-child {
      border-top-right-radius: calc(0.4 * var(--base-10));
    }
  }

  thead {
    th:first-child,
    td:first-child {
      border-top-left-radius: calc(0.4 * var(--base-10));
    }

    th:last-child,
    td:last-child {
      border-top-right-radius: calc(0.4 * var(--base-10));
    }
  }

  tfoot {
    td:first-child {
      border-bottom-left-radius: calc(0.4 * var(--base-10));
    }

    td:last-child {
      border-bottom-right-radius: calc(0.4 * var(--base-10));
    }
  }
}

th {
  background: var(--color-brand-primary);
  color: var(--color-ink-on-dark);
  @include base-space(padding, 0.8, 1.2);
  font-size: var(--font-label);
  text-align: left;
}

tfoot {
  th,
  td {
    background: var(--color-ink-muted);
    color: var(--color-ink-on-dark);
  }
}

tr {
  transition: all 250ms ease-out;

  &:nth-child(odd) {
    background: var(--color-surface-base);
  }

  &:nth-child(even) {
    background: var(--color-surface-soft);
  }

  &:hover,
  &:focus {
    background: color-mix(
      in srgb,
      var(--color-brand-primary) 90%,
      var(--color-ink-on-dark, #{$surfaceBody}) 10%
    );
    color: var(--color-ink-on-dark);
  }
}

td {
  border-bottom: 0.1rem solid var(--color-border-muted);
  @include base-space(padding, 0.8, 1.2);
  font-size: var(--font-label);
}

tr:last-child {
  td {
    border-bottom: none;
  }
}



details {
  border: 1px solid var(--color-surface-soft);
  background-color: var(--color-surface-base);
  margin-bottom: 10px;
  border-radius: 5px;
}

summary {
  background-color:var(--color-surface-soft);;
  padding: 10px;
  cursor: pointer;
  font-weight: bold;
  list-style: none; /* Removes default triangle indicator */
}

summary::marker { /* For custom indicator styling */
  content: "+ "; 
}

details[open] summary::marker {
  content: "- ";
}

details p, details ul {
  padding: 10px;
  margin: 0;
}

.avoid-break {
  display: inline-block;
  break-inside: avoid;
}

.wrapper-wide {
  @include wrapperWide;
}

.wrapper-medium {
  @include wrapperMedium;
}

.wrapper-narrow {
  @include wrapperNarrow;
}

.full-width {
  @include fullWidth;
}
/* -- GENERAL STYLES END -- */

.text-center {
  text-align: center;
}

/* -- NAV (GENERAL) START -- */
nav {
  ul {
    list-style-type: none;
    margin: 0;
    display: flex;
    gap: clamp(base-step(2), 3vw, base-step(3)); 
  }

  a {
    font-family: var(--font-sans);
    color: var(--color-ink-primary);
    display: flex;
    justify-content: center;
    align-items: center;
    text-decoration: none;
    font-size: var(--step-1);
    padding: base-step(1.6) 0;
    letter-spacing: 0.025em; /* 25/1000 */
  }

  
  a:visited {
    color: var(--color-ink-primary);
  }
  a:hover,
  a:focus {
    color: var(--color-brand-primary);
  }
}
/* -- NAV (GENERAL) END -- */


// NAVIGATION ****************************************************************


.subnav {
  &--select {
    margin-bottom: var(--space-md);
  }

  &--list {
    display: none;

    ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: var(--space-sm);
    }

    li {
      margin: 0;
    }

    a {
      display: block;
      padding: clamp(0.9rem, 2vw, 1.1rem) clamp(1.6rem, 4vw, 2.4rem);
      border-radius: var(--radius-md);
      background: rgb(var(--color-brand-primary-rgb) / 0.06);
      color: inherit;
      text-decoration: none;
      transition: background 150ms ease, color 150ms ease;
    }

    a:hover,
    a:focus {
      background: rgb(var(--color-brand-primary-rgb) / 0.12);
    }

    a[aria-current="page"] {
      background: rgb(var(--color-brand-primary-rgb) / 0.18);
      font-weight: 600;
    }
  }
}

@media (min-width: breakpoint("md")) {
  .subnav {
    &--select {
      display: none;
    }

    &--list {
      display: block;
      position: static;
      font-family: var(--font-sans);
      color: var(--color-ink-primary);
      max-width: 28rem;

      ul {
        list-style: none;
        margin: 0;
        padding: 0;
        display: grid;
        row-gap: 0.4rem;
      }

      li {
        margin: 0;

        &:not(.first) + li a {
          border-top: 1px solid rgb(var(--color-ink-absolute-rgb) / 0.06);
        }
      }

      a {
        display: block;
        text-decoration: none;
        // padding: 0.6rem 1rem;
        border-radius: var(--radius-sm);
        line-height: 1.35;
        font-size: var(--step--1);
        color: var(--color-ink-muted);
        background: transparent;
        transition: background 120ms ease, color 120ms ease;
      }

      a:hover {
        background: var(--color-surface-soft);
      }

      a:focus {
        background: transparent;
      }

      a:focus-visible {
        outline: 2px solid var(--color-focus-ring);
        outline-offset: 2px;
      }

      .current > a,
      a[aria-current="page"] {
        background: var(--color-brand-primary);
        color: var(--color-ink-on-dark);
        font-weight: 600;
      }

      // .first > a {
      //   font-family: $fontSerif;
      //   font-size: var(--step-2);
      //   font-weight: 700;
      //   color: var(--color-brand-primary);
      //   background: var(--color-surface-muted);
      //   border: 1px solid var(--color-border-muted);
      //   padding: 0.8rem 1.2rem;
      // }

    &.jumpnav  .current > a {
        position: relative;
        &::before {  // arrow pointer left
          content: "";
          position: absolute;
          left: calc(-0.95 * var(--base-10));
          top: 50%;
          transform: translateY(-50%);
          width: 0;
          height: 0;
          border-style: solid;
          border-width: calc(1 * var(--base-10)) calc(1 * var(--base-10)) calc(1 * var(--base-10)) 0;
          border-color: transparent var(--color-brand-primary) transparent  transparent;
        }

      }

      // a:visited:not([aria-current]) {
      //   color: var(--color-brand-primary-visited);
      // }
    }
  }
}

/* -- MAIN NAV START -- */
header {
  nav {
    display: inline-block;
    vertical-align: middle;
    position: relative;
    z-index: 100;

    a:link,
    a:visited {
      font-family: var(--font-serif);
      position: relative;
      text-align: center;
      height: 100%;
    }
    a:link,
    a:visited,
    a:hover,
    a:focus,
    .current > a {
      color: var(--color-ink-on-dark);
    }

    ul {
      li {
        position: relative;
        margin: 0;

        &.has-sub > a {
          position: relative;
          padding-right: clamp(3rem, 6vw, 4rem);

          &::after {
            content: "";
            position: absolute;
            top: 50%;
            right: clamp(0.8rem, 2.5vw, 1.6rem);
            width: clamp(1.6rem, 3.5vw, 2rem);
            height: clamp(1.6rem, 3.5vw, 2rem);
            transform: translateY(-50%) rotate(90deg);
            transition: transform 100ms ease-in-out;
            mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M8 6l8 6-8 6' fill='none' stroke='currentColor' stroke-width='3.2' stroke-linecap='round' stroke-linejoin='round'/></svg>");
            mask-size: cover;
            mask-repeat: no-repeat;
            mask-position: center;
            -webkit-mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M8 6l8 6-8 6' fill='none' stroke='currentColor' stroke-width='3.2' stroke-linecap='round' stroke-linejoin='round'/></svg>") center/cover no-repeat;
            background-color: currentColor;
          }
        }

        &.is-open > ul,
        &:focus-within > ul {
          opacity: 1;
          pointer-events: initial;
        }

        &.is-open.has-sub > a::after {
          transform: translateY(-50%) rotate(-90deg);
        }
      }
      // Drop menu   
      ul {
        display: block;
        opacity: 0;
        pointer-events: none;
        box-shadow: $boxShadowSubtle;
        position: absolute;
        width: max-content;
        max-width: calc(42 * var(--base-10));
        border-radius: var(--radius-xs);
        left: auto;
        right: calc(-0.2 * var(--base-10));
        transition: opacity 250ms ease-in-out;
        padding-inline-start: 0;

        &:before {
          content: "";
          width: 0;
          height: 0;
          display: block;
          border-style: solid;
          border-width: 0 calc(1.2 * var(--base-10)) calc(1.2 * var(--base-10)) calc(1.2 * var(--base-10));
          border-color: transparent transparent var(--color-ink-on-dark) transparent;
          top: calc(-1.2 * var(--base-10));
          left: auto;
          right: calc(1.6 * var(--base-10));
          position: absolute;
          z-index: 1;
          filter: drop-shadow(
            0 calc(-0.2 * var(--base-10)) calc(0.25 * var(--base-10))
              rgb(var(--color-ink-absolute-rgb) / 0.1)
          );
        }

        a:link,
        a:visited {
          font-family: var(--font-sans);
          background: rgb(var(--color-surface-base-rgb) / 0.9);
          color: var(--color-ink-primary);
          font-size: var(--step--1);
          display: block;
          text-align: left;
          @include base-space(padding, 1, 1.2, 1.2);
        }

        li {
          display: block;

          &:first-child a:link,
          &:first-child a:visited {
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
          }

          &:last-child a:link,
          &:last-child a:visited {
            border-radius: 0 0 var(--radius-sm) var(--radius-sm);
          }
        }
      }
    }

    .current .current a,
    ul ul a:hover {
      background: var(--color-surface-muted);
      color: var(--color-brand-primary);
    }
  }
}
/* -- MAIN NAV END -- */


#hdr-notice {
  background: var(--color-ink-contrast);
  color: var(--color-ink-on-dark);
  text-shadow: $textShadow;
  position: relative;
  padding: base-step(1.5) calc(4.5 * var(--base-10));

  .hdr-notice-content {
    @include wrapperNarrow;
    font-size: var(--font-label);
    position: relative;
    text-align: center;
  }

  #close-notice {
    display: inline-block;
    vertical-align: middle;
    width: calc(2.4 * var(--base-10));
    height: calc(2.4 * var(--base-10));
    padding: 0;
    mask: url(/img/icons/circle-close.svg);
    mask-size: cover;
    background: var(--color-surface-base);
    border: none;
    appearance: none;
    cursor: pointer;
    margin: calc(-0.3 * var(--base-10)) calc(0.2 * var(--base-10)) 0 0;
    transition: all 250ms ease-out;

    &:hover,
    &:focus {
      background: var(--color-brand-primary);
    }
  }

  .notice-btn:link,
  .notice-btn:visited {
    color: var(--color-ink-on-dark);
    font-weight: bold;
    text-decoration: underline;
    white-space: nowrap;
  }

  .notice-btn:hover,
  .notice-btn:focus {
    text-decoration: none;
  }
}


header {
  &.primary-hdr {
    // background: #fff;
    padding-block: base-step(2.4);
    position: fixed;
    inset: 0 0 auto 0;
    transition: padding-block 500ms ease-in-out;
    z-index: 100;

    // a:link,
    // a:visited,
    // a:hover,
    // a:focus,
    // .current > a {
    //   color: #fff;
    // }

    &::after {
      content: "";
      position: absolute;
      inset: 0;
      // background: #fff;
      box-shadow: $boxShadow;
      z-index: -1;
      opacity: 0;
      transition: opacity 500ms ease-in-out;
    }
    & img {
      --logo-width: 12rem;
    }
    &.sticking {
      & img {
        --logo-width: 9rem;
        transition: 500ms ease-in-out;
      }
      background: rgb(var(--color-surface-base-rgb) / 0.8);
      padding-block: 0.5rem;
      backdrop-filter: blur(4px);

      &::after {
        opacity: 1;
      }
      & a:link,
      & a:visited,
      & a:hover,
      & a:focus,
      & .current > a {
        color: var(--color-ink-absolute);
      }
    }
  }
}

.layout-rail {
  @include container-inline("directory-max");
  padding-inline: clamp(2.4rem, 6.5vw, 4.4rem);

  & + & {
    margin-top: var(--space-xl);
  }
}

.hdr-container {
  @include wrapperMedium;
  display: flex;
  align-items: center;
  gap: 2.4rem;
}

.hdr-links {
  margin-right: calc(-0.5 * var(--inline-padding));
}

.logo {
  margin: 0 auto 0 0;

  img {
    width: var(--logo-width);
  }
}
:root{ --drift: 6px; --dur: 2.4s; --tilt: 5deg; }
.logo img{
  display:block;
  transform-origin:50% 50%;
  backface-visibility:hidden;

  /* Resting pose + exit easing */
  transform: translate(0,0) rotate(0deg);
  transition: transform 500ms ease-out;
}

/* unchanged from your version */
@keyframes xy-circle {
  0%   { transform: translate( 0, calc(-1*var(--drift))) rotate(calc(-1*var(--tilt))); }
  12.5%{ transform: translate(calc(-0.707*var(--drift)), calc(-0.707*var(--drift))) rotate(calc(-1*var(--tilt))); }
  25%  { transform: translate(calc(-1*var(--drift)), 0) rotate(calc(-0.6*var(--tilt))); }
  37.5%{ transform: translate(calc(-0.707*var(--drift)),  calc(0.707*var(--drift))) rotate(var(--tilt)); }
  50%  { transform: translate(0, var(--drift)) rotate(var(--tilt)); }
  62.5%{ transform: translate(calc(0.707*var(--drift)),  calc(0.707*var(--drift))) rotate(var(--tilt)); }
  75%  { transform: translate(var(--drift), 0) rotate(calc(0.6*var(--tilt))); }
  87.5%{ transform: translate(calc(0.707*var(--drift)), calc(-0.707*var(--drift))) rotate(calc(-1*var(--tilt))); }
  100% { transform: translate(0, calc(-1*var(--drift))) rotate(calc(-1*var(--tilt))); }
}

/* Enter: glide to the 0% pose, then start the loop from that exact pose */
.logo:is(:hover, :focus-visible) img{
  /* 1) pose-into-start (no jump) */
  transform: translate(0, calc(-1*var(--drift))) rotate(calc(-1*var(--tilt)));

  /* 2) after the glide, the animation takes over from 0% seamlessly */
  animation: xy-circle var(--dur) linear infinite;
  animation-delay: 200ms;                 /* match transition duration */
  animation-play-state: running;
}

/* Reduced motion: no animation; keep a gentle pose-in if you like */
@media (prefers-reduced-motion: reduce){
  .logo:is(:hover, :focus-visible) img{
    animation: none;
    /* optional: comment out next line to avoid any movement */
    transform: translate(0, calc(-0.5*var(--drift))) rotate(calc(-0.5*var(--tilt)));
  }
}


/* === Banner base === */
.banner {
  position: relative;
  min-height: clamp(
    calc(32 * var(--base-10)),
    70svh,
    calc(82 * var(--base-10))
  ); /* tall enough on phones, capped on desktop */
  color: var(--color-ink-on-dark);
  isolation: isolate; /* keep overlay layers scoped */
}

/* Make the <picture>/<img> fully cover the banner area */
.banner picture,
.banner picture > img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* Contrast gradient (image remains visible, text stays readable) */
.banner::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: 0;
  background: linear-gradient(
    180deg,
    rgb(var(--color-ink-absolute-rgb) / 0.45),
    rgb(var(--color-ink-absolute-rgb) / 0.55)
  );
}

/* === Overlay layout === */
.banner .overlay {
  position: absolute;
  inset: 0;
  z-index: 1;

  /* grid with fluid gutters + centered content rail */
  display: grid;
  grid-template-columns:
    [edge] minmax(16px, 1fr)
    [content] minmax(0, 1200px)
    [edge-end] minmax(16px, 1fr);
  align-items: center; /* vertical centering */
  padding-top: calc(var(--nav-offset) + clamp(1.6rem, 4vw, 3.6rem));
}

/* Lower-third option:
.banner .overlay { align-items: end; padding-block-end: clamp(24px, 8vh, 96px); }
*/

.banner .text-block {
  grid-column: content; /* keep text on the centered rail */
  display: flex;
  flex-direction: column;
  gap: 1rem; /* tight control between title and button */
  // max-width: 100ch;         /* avoid ultra-long lines on huge screens */
}

/* Title */
.banner .header-tagline {
  display: block;
  font-weight: 700;
  font-family: var(--font-serif);
  line-height: 1.08;
  font-size: clamp(calc(3.5 * var(--base-10)), 5vw, calc(6 * var(--base-10)));
  text-wrap: balance; /* nicer multi-line breaks on supporting browsers */
  margin: 0 0 0.25em;
  line-height: 1.5;
  text-transform: uppercase;
  color: var(--color-ink-on-dark) !important;
}

/* Button */
.banner .btn {
  align-self: flex-start;
  // display: inline-block;
  // padding: .85rem 1.2rem;
  // border-radius: 0;
  background: var(--color-brand-accent);
  color: var(--color-ink-contrast);
  // text-decoration: none;
  // font-weight: 400;
  // box-shadow: 0 6px 18px rgba(0,0,0,.25);
}

/* Small-screen refinements */
@media (max-width: breakpoint("sm")) {
  .banner .text-block {
    gap: 0.875rem;
  }
  .banner .btn {
    padding: 0.8rem 1.1rem;
  }
}

.body-content {
  padding-bottom: clamp(3.2rem, 3.30189vw, 5.6rem);

}

.home-content {
  main.home {
    padding-block-start: clamp(3.2rem, 5vw, 6.4rem);
  }
}

.home__title {
  margin: 0 0 clamp(1.6rem, 3vw, 4rem);
  color: var(--color-brand-primary);
}

/* ===== Layout for the pair ===== */
.feature-boxes {
  @include wrapperMedium;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: clamp(16px, 3vw, 28px);
  align-items: stretch;
  margin-block: clamp(3.2rem, 3.30188679245283vw, 5.6rem); /* 48/1696 */
}

/* Mobile: stack the cards (already true below), also make them shorter */
@media (max-width: breakpoint("sm")) {
  .feature-boxes {
    grid-template-columns: 1fr;
  }
}

/* ===== Card (the <a>) ===== */
.feature-boxes > a {
  position: relative;
  display: block;
  overflow: hidden;
  // border: 2px solid rgba(0,0,0,.12);
  background: var(--color-ink-absolute);
  isolation: isolate;
  text-decoration: none;
  color: var(--color-ink-on-dark);
  -webkit-tap-highlight-color: rgb(var(--color-surface-base-rgb) / 0.15);
  touch-action: manipulation;

  /* Tablet & desktop: always square */
  aspect-ratio: 1 / 1;

  &:visited,
  &:active {
    color: var(--color-ink-on-dark);
  }

  /* Accessible focus ring */
  &:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px rgb(var(--color-surface-base-rgb) / 0.85),
      0 0 0 4px rgb(var(--color-ink-absolute-rgb) / 0.35);
  }
}

/* Mobile: shorter, banner-like cards (still responsive) */
@media (max-width: breakpoint("sm")) {
  .feature-boxes > a {
    aspect-ratio: 16 / 9; /* shorter than square */
  }
}

/* Image covers the card */
.feature-boxes picture,
.feature-boxes picture > img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  z-index: -2;
}

/* Lighter overlay */
.feature-boxes > a::after {
  content: "";
  position: absolute;
  inset: 0;
  z-index: -1;
  background: linear-gradient(
    180deg,
    rgb(var(--color-ink-absolute-rgb) / 0.18) 0%,
    rgb(var(--color-ink-absolute-rgb) / 0.36) 100%
  );
  transition: opacity 0.25s ease;
}

/* ===== Text block ===== */
.feature-text {
  position: absolute;
  left: clamp(20px, 3.6vw, 34px);
  right: clamp(20px, 3.6vw, 34px);
  bottom: clamp(20px, 3.6vw, 34px);
  color: var(--color-ink-on-dark);
  pointer-events: none; /* whole card clickable */
}

/* Headline with underline + masked arrow */
.feature-text h2 {
  margin: 0;
  display: inline-flex;
  align-items: center;
  gap: 0.45em;
  font-weight: 600;
  color: var(--color-ink-on-dark);
  text-transform: uppercase;
  letter-spacing: 0.015em;
  line-height: 1.05;
  font-size: clamp(calc(2 * var(--base-10)), 3vw, calc(4 * var(--base-10)));
  text-wrap: nowrap;
  text-shadow: 0 1px 2px rgb(var(--color-ink-absolute-rgb) / 0.45);
  position: relative;
  padding-bottom: 0.5rem;
  padding-right: 1.4em; /* reserve space for arrow */
}

/* Underline stops before arrow */
.feature-text h2::before {
  content: "";
  position: absolute;
  left: 0;
  right: 4em; /* keep the line away from the arrow */
  bottom: 0;
  height: 3px;
  background: currentColor;
  opacity: 0.9;
  transition: right 0.25s ease;
}

/* Arrow via mask (rounded stroke) */
.feature-text h2::after {
  content: "";
  display: inline-block;
  width: 1em;
  height: 1em; /* 1:1 arrow box */
  background-color: currentColor;
  mask: url("data:image/svg+xml;utf8,\
    <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'>\
      <path d='M3 12h14M13 6l6 6-6 6' fill='none' stroke='currentColor' stroke-width='3.2' stroke-linecap='round' stroke-linejoin='round'/>\
    </svg>")
    center / contain no-repeat;
  transform: translateY(0.05em);
  transition: transform 0.25s ease;
}

/* ===== Hover / Focus / Touch states (same visuals) ===== */
.feature-boxes > a picture > img {
  transition: transform 0.35s ease;
  will-change: transform;
}

/* mouse hover */
.feature-boxes > a:hover picture > img {
  transform: scale(1.04);
}
.feature-boxes > a:hover::after {
  opacity: 0.65;
}
.feature-boxes > a:hover .feature-text h2::before {
  right: 3em;
}

/* keyboard focus */
.feature-boxes > a:focus-visible picture > img {
  transform: scale(1.04);
}
.feature-boxes > a:focus-visible::after {
  opacity: 0.65;
}
.feature-boxes > a:focus-visible .feature-text h2::before {
  right: 3em;
}

/* touch active (devices without hover) */
@media (hover: none) {
  .feature-boxes > a:active picture > img {
    transform: scale(1.03);
  }
  .feature-boxes > a:active::after {
    opacity: 0.62;
  }
  .feature-boxes > a:active .feature-text h2::before {
    right: 3em;
  }
}

/* Screen reader CTA (not needed; title serves as name) */
.feature-cta { 
  display: none;
}

/* Motion respect */
@media (prefers-reduced-motion: reduce) {
  .feature-boxes > a *,
  .feature-boxes > a::after {
    transition: none !important;
  }
}
/* ==== Section (full-width platter) ==== */
.secondary-content {

  --frame: var(--color-ink-on-dark);
  --text: var(--color-ink-on-dark);
  --text-muted: var(--color-ink-overlay);

  padding-block: clamp(20px, 4vw, 40px);
  margin-bottom: clamp(3.2rem, 3.30189vw, 5.6rem);
  position: relative;
  overflow: hidden;
  background: transparent; /* key */
  color: var(--color-ink-on-dark);
}

/* Blue tint that multiplies with page tile */
.secondary-content:before {
  content: "";
  position: absolute;
  inset: 0;
  background: var(--color-brand-secondary);
  mix-blend-mode: multiply;
  pointer-events: none;
  z-index: 0;
}

/* Local contrast lift within the oval only */
.secondary-content:after {
  content: "";
  position: absolute;
  inset: 0;
  background: rgb(var(--color-surface-base-rgb) / 0.001); /* trigger backdrop pipeline */
  backdrop-filter: contrast(3.75) brightness(9) ;
  pointer-events: none;
  z-index: 0;
}

/* wrapperMedium equivalent */
.secondary-content__inner {
  width: calc(100% - var(--inline-padding, 24px) * 2);
  max-width: 120rem;
  margin-inline: auto;
  display: grid;
  grid-template-columns: 1fr 1fr; /* text : image */
  gap: clamp(16px, 3.5vw, 36px);
  align-items: stretch;
  position: inherit;
  z-index: 2;
}

/* copy column */
.secondary-content__copy {
  color: var(--text);
}
.secondary-content__copy h2 {
  margin: 0 0 clamp(8px, 2vw, 12px);
  font-family: var(--font-serif);
  font-weight: 600;
  line-height: 1.2;
  letter-spacing: 0.02em;
  color: var(--text);
  font-size: clamp(calc(2.2 * var(--base-10)), 3.2vw, calc(3.6 * var(--base-10)));
  text-transform: uppercase;
}

/* bullets */
.secondary-content__copy ul {
  margin: 0 0 clamp(12px, 3vw, 20px);
  padding-left: 1.2em;
  color: var(--text-muted);
  font-size: var(--step-1);
}
.secondary-content__copy li {
  margin: 0.35em 0;
}

/* optional CTA */
.secondary-content .btn {
  display: inline-block;
  margin-top: 0.75rem;
  padding: 0.6rem 0.9rem;
  border-radius: var(--radius-max);
  background: var(--color-brand-accent);
  color: var(--color-ink-on-dark);
  text-decoration: none;
  font-weight: 600;
}

/* === Secondary content (mobile-first) === */

/* 1) Layout: stack on mobile */
.secondary-content__inner {
  width: calc(100% - var(--inline-padding, 24px) * 2);
  max-width: 120rem;
  margin-inline: auto;

  display: grid;
  grid-template-columns: 1fr; /* mobile: stack */
  row-gap: clamp(16px, 5vw, 24px);
  align-items: stretch;
}

/* 2) Media: ratio on the CONTAINER (mobile = 16:10) */
.secondary-content__media {
  position: relative;
  overflow: hidden;
  aspect-ratio: 16 / 9; /* match feature-boxes mobile */
  /* optional: put image first on mobile */
  order: -1;
}

/* Fill the box */
.secondary-content__media picture,
.secondary-content__media img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

/* 3) Tablet+ adjustments */
@media (min-width: breakpoint("sm")) {
  .secondary-content__inner {
    grid-template-columns: 1fr 1fr; /* two columns */
    column-gap: clamp(16px, 3.5vw, 36px);
    row-gap: 0;
  }

  .secondary-content__media {
    aspect-ratio: 1 / 1; /* square like feature cards */
    order: 0; /* normal flow */
  }

  .secondary-content__copy {
    display: flex;
    flex-direction: column;
    justify-content: center; /* vertically center text */
  }
}

.home-content {
  @include wrapperNarrow;
}

main {
  p,
  ul,
  ol,
  dl,
  pre,
  code,
  table {
    &:last-child {
      margin-bottom: 0;
    }
  }

  pre {
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  ul {
    ul,
    ol {
      margin-bottom: 0;
    }
  }

  ol {
    ol,
    ul {
      margin-bottom: 0;
    }
  }

  li::marker {
    color: var(--color-brand-primary);
  }

  ol > li::marker {
    font-weight: bold;
  }

  dl {
    dt {
      color: var(--color-brand-primary);
      font-style: normal;
    }
  }
}

// .contact-content {
//   display: grid;
//   grid-template-columns: repeat(auto-fill, minmax(32rem, 1fr));
//   gap: 2.4rem;
// }

.contact-text {
  main & {
    h2 {
      margin: 0;
      font-size: calc(3.2 * var(--base-10));
      &:not(:first-child) {
        margin-top: var(--space-lg); 
      } 
    }
  }
}

.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(14rem, 1fr));
  gap: 2.4rem;
  margin-block: clamp(3.2rem, 3.30188679245283vw, 5.6rem); /* 48/1696 */

  a {
    border-radius: var(--radius-xs);
    outline: 0.1rem solid #{$brandPrimary}00;
    outline-offset: -0.4rem;
    box-shadow: $boxShadowSubtle;

    &:hover {
      outline: 0.1rem solid #{$brandPrimary}ff;
      outline-offset: 0.2rem;
      box-shadow: $boxShadow;
    }
  }

  img {
    display: block;
    border-radius: var(--radius-sm);
    width: 100%;
  }
}

.breadcrumbs {
  font-size: var(--step-0);
  margin: 0 0 calc(4.5 * var(--base-10));

  .brdcrmb-dvdr {
    display: inline-block;
    margin: 0 0.2rem;
    width: calc(1.1 * var(--base-10));
    height: calc(1.1 * var(--base-10));
    mask: url(/img/icons/dbl-arrow.svg);
    mask-size: cover;
    background: var(--color-ink-subtle);
  }

  .current {
    font-weight: bold;
    color: var(--color-brand-primary);
  }
}

.pagination-top-text {
  font-size: var(--font-compact);
  margin: 0 0.5rem;
  font-style: italic;
  color: var(--color-ink-subtle);
}

.pagination {
  display: flex;
  flex-wrap: wrap;
  gap: 1.2rem;
  font-size: var(--step-0);
  justify-content: center;
  align-items: center;
  margin: 5.6rem 0 2.4rem;

  span {
    height: 1.75em;
    line-height: 1.75em;
  }

  .number {
    text-align: center;
    width: 1.75em;
    padding: 0;

    &.current {
      color: var(--color-ink-on-dark);
      background: var(--color-brand-primary);
      border-radius: var(--radius-max);
    }

    a:link,
    a:visited {
      padding: 0;
      width: 1.75em;
      height: 1.75em;
    }
  }

  a:link,
  a:visited {
    background: var(--color-border-soft);
    text-decoration: none;
    color: var(--color-ink-deep);
    display: inline-block;
    text-align: center;
    width: 100%;
    height: 100%;
    padding: 0 1.5rem;
    border-radius: var(--radius-max);
  }

  a:hover,
  a:focus {
    color: var(--color-ink-on-dark);
    background: var(--color-ink-deep);
  }

  a:empty {
    display: none;
  }
}

/* === Footer CTA (hero-style) === */
.footer-cta {
  /* push away from footer edge a bit */
  @include wrapperMedium;
  background: transparent; /* keep your page bg/pattern */
}

.footer-cta > div {
  position: relative;
  // max-width: 1200px;
  // margin-inline: auto;
  // /* side gutters */
  // padding-inline: clamp(12px, 3vw, 24px);
}

/* image frame */
.footer-cta picture {
  display: block;
  overflow: hidden;
  /* white frame like the mock */
  // outline: clamp(10px, 1.4vw, 16px) solid #fff;
  box-shadow: 0 10px 30px rgb(var(--color-ink-absolute-rgb) / 0.15);
}
.footer-cta img {
  display: block;
  width: 100%;
  height: auto;
  object-fit: cover;
  aspect-ratio: 21 / 9; /* keeps hero feel at wide sizes */
}

/* overlay layer */
.footer-cta .text-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: end;
  justify-content: flex-end; /* push text to right like comp */
  padding: clamp(16px, 4vw, 64px);
  pointer-events: none; /* image stays non-interactive anyway */
}

/* contrast gradient (right side â†’ fades left) */
.footer-cta .text-overlay::before {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to left,
    rgb(var(--color-ink-absolute-rgb) / 0.55) 0%,
    rgb(var(--color-ink-absolute-rgb) / 0.3) 30%,
    rgb(var(--color-ink-absolute-rgb) / 0.12) 55%,
    rgb(var(--color-ink-absolute-rgb) / 0) 75%
  );
}

/* headline style */
.footer-cta .text-overlay h2 {
  position: relative;
  max-width: 30ch; /* tight column like the mock */
  margin: 0;
  color: var(--color-ink-on-dark);
  text-align: right;
  letter-spacing: 0.08em;
  line-height: 1.35;
  font-weight: 500;
  font-size: clamp(calc(2.2 * var(--base-10)), 3.2vw, calc(4.2 * var(--base-10)));
  /* Prefer a classic serif; falls back cleanly */
  font-family: var(--font-serif);
  text-shadow: 0 1px 2px rgb(var(--color-ink-absolute-rgb) / 0.25); /* crisp on bright water */
}

/* Responsiveness */
@media (max-width: breakpoint("md")) {
  .footer-cta img {
    aspect-ratio: 16 / 9;
  } /* a bit taller on tablets */
}
@media (max-width: breakpoint("sm")) {
  .footer-cta .text-overlay {
    justify-content: center;
    text-align: center;
    padding: clamp(14px, 6vw, 28px);
  }
  .footer-cta .text-overlay::before {
    /* more uniform darkening on small screens */
    background: linear-gradient(
      to bottom,
      rgb(var(--color-ink-absolute-rgb) / 0.45) 0%,
      rgb(var(--color-ink-absolute-rgb) / 0.25) 40%,
      rgb(var(--color-ink-absolute-rgb) / 0.1) 70%,
      rgb(var(--color-ink-absolute-rgb) / 0) 100%
    );
  }
  .footer-cta .text-overlay h2 {
    text-align: center;
    max-width: 26ch;
  }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
  }
}

/* ===== Footer theme tokens (defined in stylesheet.scss :root) ===== */
footer {
  background: var(--ftr-bg);
  color: var(--ftr-fg);
  font-size: var(--ftr-font);
}

footer a,
footer a:link,
footer a:visited {
  color: var(--ftr-link);
  text-decoration: none;
  transition: none !important;
}
footer a:hover,
footer a:focus {
  color: var(--ftr-link);
  text-decoration: underline;
  text-underline-offset: 2px;
}

/* container */
.ftr-container {
  max-width: var(--ftr-maxw);
  margin-inline: auto;
  padding: var(--ftr-padY) clamp(16px, 4vw, 24px);
}

/* top row: nav centered; social optional */
.ftr-top {
  display: grid;
  justify-items: center;
  align-items: center;
  gap: var(--ftr-gap);
}

/* navigation list from CMS */
.ftr-top nav ul {
  display: flex;
  flex-wrap: wrap;
  gap: clamp(12px, 3vw, 36px);
  list-style: none;
  padding: 0;
  margin: 0;
}
.ftr-top nav li {
  margin: 0;
}
.ftr-top nav a {
  font-weight: 600;
  letter-spacing: 0.02em;
}

/* social block (your element output may vary) */
.ftr-top .social,
.ftr-top .social-media,
.ftr-top [class*="social"] ul {
  display: flex;
  gap: 12px;
  list-style: none;
  padding: 0;
  margin: 0;
}

/* contact line */
.ftr-contact {
  margin-top: clamp(10px, 2vw, 18px);
  text-align: center;
  color: var(--ftr-muted);
}
.ftr-contact .divider {
  display: inline-block;
  padding: 0 0.6rem;
  opacity: 0.6;
  line-height: 1;
}
.ftr-contact .divider::before {
  content: "|";
}

/* thin rule + copyright */
.copyright {
  margin-top: clamp(14px, 3vw, 22px);
  padding-block: clamp(12px, 2vw, 16px);
  border-top: 1px solid var(--ftr-rule);
  text-align: center;
  color: var(--ftr-muted);
  line-height: 1.4;
  font-size: calc(1.2 * var(--base-10));
}
.avoid-break {
  white-space: nowrap;
}

/* responsive tidy-ups */
@media (max-width: breakpoint("sm")) {
  .ftr-top nav ul {
    gap: 16px;
  }
  .ftr-top nav a {
    font-weight: 600;
  }
  .ftr-contact {
    font-size: calc(1.3 * var(--base-10));
  }
}

/* prefers-reduced-motion: keep it calm */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
  }
}

@media screen and (max-width: breakpoint("xs")) {
  html {
    font-size: 2.083333333333333vw; /* 10/480 */
  }
}

@media screen and (min-width: breakpoint("lg")) {
  a[href^="tel:"] {
    text-decoration: none;
    cursor: default;
  }
}



